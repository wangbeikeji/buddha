<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<!-- css -->
<link href="../css/bootstrap.min.css" rel="stylesheet">
<link href="../css/custom.css" rel="stylesheet">

<!-- js -->
<script src="../js/jquery-2.1.1.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script src="../js/ueditor/third-party/zeroclipboard/ZeroClipboard.min.js"></script>
<script src="../js/ueditor/ueditor.config.js"></script>
<script src="../js/ueditor/ueditor.parse.min.js"></script>
<script src="../js/ueditor/ueditor.all.min.js"></script>
<script type="text/javascript">
function GetQueryString(name)
{
     var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
     var r = window.location.search.substr(1).match(reg);
     if(r!=null)return  unescape(r[2]); return null;
}

$(function(){
	var type = GetQueryString("type");
	if(type == '1') {
		$("#backBtn").attr("href", "list.html?type=1");
	} else if(type == '2') {
		$("#backBtn").attr("href", "list.html?type=2");
	} else if(type == '3') {
		$("#backBtn").attr("href", "list.html?type=3");
	}
	
	var uEditor1 = UE.getEditor('knowledgeLinkEditor');
	var uEditor2 = UE.getEditor('knowledgeContextEditor');
	// 增加
	$("#addKnowledgeBtn").click(function() {
		if($("#addKnowledgeForm input[name=sortNum]").val() == "") {
			$("#addKnowledgeForm input[name=sortNum]").val("0");
		}
		$.ajax({ 
			url: "/buddha/knowledge/", 
			type: "post",
			headers: {
				Authorization: "eyJhbGciOiJIUzUxMiJ9.eyJhdXRob3JpdGllcyI6IiIsInVzZXJJZCI6Mywic3ViIjoiMTM5Mjg5NTIyNTQiLCJleHAiOjQ0NzAwMDA2OTY1fQ._r485hISBsKmopDQ8JysYg3O9j85ae_ulpLDt1BnKqUq3XvpNjUWsS_YoL9KTH9Vnhy2_EPJeCj83ADBKyV4bg"
			},
			dataType: "json",
			data: $("#addKnowledgeForm").serialize(),
			success: function(response) {
				if(response.code === "200") {
					window.history.back();
				} else {
					alert(response.message);
				}
			}
		});
	});
});
</script>
</head>
<body>
	<div class="row">
		<div class="col-md-2"></div>
		<div class="col-md-8">
			<div class="bs-callout bs-callout-info" id="callout-type-dl-truncate">
				<h4>新增页面</h4>
			</div>

			<div class="button-list">
				<a id="backBtn" class="btn btn-default" href="list.html" role="button"> 返 回 </a>
			</div>


			<div class="bs-callout bs-callout-info" id="callout-type-dl-truncate">
				<form id="addKnowledgeForm" class="form-horizontal">
					<div class="form-group">
						<label class="col-sm-1 control-label">标题</label>
						<div class="col-sm-10">
							<input name="title" type="text" class="form-control" placeholder="标题">
						</div>
						<div class="col-sm-1"></div>
					</div>
					<div class="form-group">
						<label class="col-sm-1 control-label">摘要</label>
						<div class="col-sm-10">
							<input name="summary" type="text" class="form-control" placeholder="摘要">
						</div>
						<div class="col-sm-1"></div>
					</div>
					<div class="form-group">
						<label class="col-sm-1 control-label">类型</label>
						<div class="col-sm-10">
							<select name="type" class="form-control">
							  	<option value="1">咨询</option>
							  	<option value="2">故事</option>
							  	<option value="3">入门</option>
							</select>
						</div>
						<div class="col-sm-1"></div>
					</div>
					<div class="form-group">
						<label class="col-sm-1 control-label">排序</label>
						<div class="col-sm-10">
							<input name="sortNum" type="number" class="form-control" placeholder="排序">
						</div>
						<div class="col-sm-1"></div>
					</div>
					<div class="form-group">
						<label class="col-sm-1 control-label">缩略图</label>
						<div class="col-sm-10">
							<script type="text/plain" name="link" id="knowledgeLinkEditor" style="min-height: 300px;"></script>
						</div>
						<div class="col-sm-1"></div>
					</div>
					<div class="form-group">
						<label class="col-sm-1 control-label">内容</label>
						<div class="col-sm-10">
							<script type="text/plain" name="context" id="knowledgeContextEditor" style="min-height: 300px;"></script>
						</div>
						<div class="col-sm-1"></div>
					</div>
					<div class="form-group">
						<div class="col-sm-offset-1 col-sm-10">
							<button id="addKnowledgeBtn" type="button" class="btn btn-default">　新　增　</button>
						</div>
					</div>
				</form>
			</div>
		</div>
		<div class="col-md-2"></div>
	</div>
</body>
</html>